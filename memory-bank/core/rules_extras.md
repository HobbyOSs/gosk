# rules_extras

## 詳細な運用方針や具体的コード例

こちらには、.clinerules に記載するには詳細すぎるポリシー、手順、サンプルコードなどを記述します。

### テスト実行ポリシー

1. **テスト実行の基本ルール**
   - `go test` 等の実行時は必ずターゲットを明示し、`-run` などでフィルタする
   - テストは最小単位で実行し、必要な部分のみをテスト
   - 全体テストは変更完了後に実施

2. **テストケース作成ガイドライン**
   - 各機能の基本動作を確認するテスト
   - エッジケースの網羅
   - 他の機能との相互作用の確認

### JSON調査方法

1. **asmdb JSONファイルの調査**
   ```bash
   # 特定の命令のエンコーディング情報を取得
   jq '.instructions["INST_NAME"]' pkg/asmdb/json-x86-64/x86_64.json

   # オペランドタイプの一覧を取得
   jq '.instructions["INST_NAME"].forms[].operands[].type' pkg/asmdb/json-x86-64/x86_64.json
   ```

2. **jqクエリのベストプラクティス**
   - パイプを使用して段階的にフィルタリング
   - 必要な情報のみを抽出
   - 結果は可読性の高いフォーマットで出力

### ソースコード修正ポリシー

1. **コード変更の基本ルール**
   - 変更は最小限に留める
   - 既存のパターンを踏襲
   - コメントで変更理由を明記

2. **リファクタリングガイドライン**
   - 同様のパターンが3回以上出現したら抽象化を検討
   - ユーティリティ関数は適切な場所に配置
   - テストカバレッジを維持

3. **命名規則**
   - 関数名は動詞から始める（例：processINST, handleINST）
   - 変数名は目的を明確に（例：opcodeBytes, registerNum）
   - 定数は大文字のスネークケース（例：MAX_OPERANDS）

4. **エラー処理**
   - エラーは適切な層で処理
   - エラーメッセージは具体的に
   - パニックは最小限に

### レビュー・デプロイのポリシー

1. **コードレビューのチェックポイント**
   - 既存の実装パターンとの整合性
   - テストの十分性
   - エラー処理の適切性
   - ドキュメントの更新

2. **デプロイ前の確認事項**
   - 全テストの成功
   - lint エラーの解消
   - ドキュメントの更新確認
